<html><head><title>CHARMM-Conformation-search-docs</title><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">.lst-kix_1wqoavz9rnai-8>li:before{content:"\0025a0  "}.lst-kix_6xt1kwty0bal-1>li:before{content:"\0025cb  "}.lst-kix_6xt1kwty0bal-0>li:before{content:"\0025cf  "}.lst-kix_1wqoavz9rnai-6>li:before{content:"\0025cf  "}ul.lst-kix_6xt1kwty0bal-0{list-style-type:none}ul.lst-kix_6xt1kwty0bal-1{list-style-type:none}.lst-kix_1wqoavz9rnai-3>li:before{content:"\0025cf  "}ul.lst-kix_6xt1kwty0bal-2{list-style-type:none}ul.lst-kix_6xt1kwty0bal-3{list-style-type:none}.lst-kix_6xt1kwty0bal-8>li:before{content:"\0025a0  "}.lst-kix_1wqoavz9rnai-0>li:before{content:"\0025cf  "}ul.lst-kix_1wqoavz9rnai-6{list-style-type:none}ul.lst-kix_1wqoavz9rnai-5{list-style-type:none}.lst-kix_1wqoavz9rnai-2>li:before{content:"\0025a0  "}.lst-kix_1wqoavz9rnai-1>li:before{content:"\0025cb  "}ul.lst-kix_1wqoavz9rnai-8{list-style-type:none}ul.lst-kix_1wqoavz9rnai-7{list-style-type:none}.lst-kix_6xt1kwty0bal-2>li:before{content:"\0025a0  "}.lst-kix_1wqoavz9rnai-5>li:before{content:"\0025a0  "}ul.lst-kix_6xt1kwty0bal-5{list-style-type:none}ul.lst-kix_6xt1kwty0bal-4{list-style-type:none}ul.lst-kix_6xt1kwty0bal-7{list-style-type:none}ul.lst-kix_6xt1kwty0bal-6{list-style-type:none}.lst-kix_6xt1kwty0bal-6>li:before{content:"\0025cf  "}.lst-kix_1wqoavz9rnai-4>li:before{content:"\0025cb  "}ul.lst-kix_6xt1kwty0bal-8{list-style-type:none}.lst-kix_6xt1kwty0bal-3>li:before{content:"\0025cf  "}.lst-kix_6xt1kwty0bal-4>li:before{content:"\0025cb  "}ul.lst-kix_1wqoavz9rnai-0{list-style-type:none}ul.lst-kix_1wqoavz9rnai-3{list-style-type:none}ul.lst-kix_1wqoavz9rnai-4{list-style-type:none}.lst-kix_6xt1kwty0bal-5>li:before{content:"\0025a0  "}ul.lst-kix_1wqoavz9rnai-1{list-style-type:none}.lst-kix_6xt1kwty0bal-7>li:before{content:"\0025cb  "}ul.lst-kix_1wqoavz9rnai-2{list-style-type:none}.lst-kix_1wqoavz9rnai-7>li:before{content:"\0025cb  "}ol{margin:0;padding:0}.c2{padding-left:0pt;widows:2;orphans:2;direction:ltr;margin-left:72pt}.c0{padding-left:0pt;widows:2;orphans:2;direction:ltr;margin-left:36pt}.c6{widows:2;orphans:2;direction:ltr}.c11{max-width:468pt;background-color:#ffffff;padding:72pt 72pt 72pt 72pt}.c12{color:#545454;background-color:#ffffff}.c1{color:#1155cc;text-decoration:underline}.c3{font-size:11pt;font-family:"Arial"}.c4{color:inherit;text-decoration:inherit}.c5{margin:0;padding:0}.c7{page-break-after:avoid}.c9{height:11pt}.c8{font-family:"Courier New"}.c10{vertical-align:super}.title{widows:2;padding-top:0pt;line-height:1.15;orphans:2;text-align:left;color:#000000;font-size:21pt;font-family:"Trebuchet MS";padding-bottom:0pt;page-break-after:avoid}.subtitle{widows:2;padding-top:0pt;line-height:1.15;orphans:2;text-align:left;color:#666666;font-style:italic;font-size:13pt;font-family:"Trebuchet MS";padding-bottom:10pt;page-break-after:avoid}li{color:#000000;font-size:11pt;font-family:"Arial"}p{color:#000000;font-size:11pt;margin:0;font-family:"Arial"}h1{widows:2;padding-top:10pt;line-height:1.15;orphans:2;text-align:left;color:#000000;font-size:16pt;font-family:"Trebuchet MS";padding-bottom:0pt;page-break-after:avoid}h2{widows:2;padding-top:10pt;line-height:1.15;orphans:2;text-align:left;color:#000000;font-size:13pt;font-family:"Trebuchet MS";font-weight:bold;padding-bottom:0pt;page-break-after:avoid}h3{widows:2;padding-top:8pt;line-height:1.15;orphans:2;text-align:left;color:#666666;font-size:12pt;font-family:"Trebuchet MS";font-weight:bold;padding-bottom:0pt;page-break-after:avoid}h4{widows:2;padding-top:8pt;line-height:1.15;orphans:2;text-align:left;color:#666666;font-size:11pt;text-decoration:underline;font-family:"Trebuchet MS";padding-bottom:0pt;page-break-after:avoid}h5{widows:2;padding-top:8pt;line-height:1.15;orphans:2;text-align:left;color:#666666;font-size:11pt;font-family:"Trebuchet MS";padding-bottom:0pt;page-break-after:avoid}h6{widows:2;padding-top:8pt;line-height:1.15;orphans:2;text-align:left;color:#666666;font-style:italic;font-size:11pt;font-family:"Trebuchet MS";padding-bottom:0pt;page-break-after:avoid}</style></head><body class="c11"><p class="c6 c7 title"><a name="h.x0n17lq395xg"></a><span>Conformation Search Using CHARMM</span></p><h1 class="c6 c7"><a name="h.9lgnhvnvngfs"></a><span>Description</span></h1><p class="c6"><span>This set of scripts performs a replica exchange molecular dynamics (a.k.a., parallel tempering) simulation of a molecule using the CHARMM molecular mechanical modeling code. The final structures of the simulations are then minimized. This provides a method to find low-energy conformations of a molecule.</span></p><h1 class="c6 c7"><a name="h.gjpspphyjmkp"></a><span>Requirements</span></h1><p class="c6"><span>These scripts use several other molecular modeling programs in combination to generate the initial coordinates, molecular structure, topology, and parameters. For the example calculation to work, the following software must be installed:</span></p><ul class="c5 lst-kix_6xt1kwty0bal-0 start"><li class="c0"><span>CHARMM (</span><span class="c1"><a class="c4" href="http://www.google.com/url?q=http%3A%2F%2Fwww.charmm.org%2F&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNE1fJ9ZEjTI1QX2KcH2_lDv8QDnbQ">http://www.charmm.org/</a></span><span>)</span></li></ul><ul class="c5 lst-kix_6xt1kwty0bal-1 start"><li class="c2"><span>tested with version c38b2</span></li></ul><ul class="c5 lst-kix_6xt1kwty0bal-0"><li class="c0"><span>Antechamber (part of AmberTools, </span><span class="c1"><a class="c4" href="http://www.google.com/url?q=http%3A%2F%2Fambermd.org%2F%23AmberTools&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFRMLeg8-h9UtN9zLTKYDSoGI3eWg">http://ambermd.org/</a></span><span>)</span></li></ul><ul class="c5 lst-kix_6xt1kwty0bal-1 start"><li class="c2"><span>tested with AmberTools14</span></li></ul><ul class="c5 lst-kix_6xt1kwty0bal-0"><li class="c0"><span>OpenBabel &nbsp;(</span><span class="c1"><a class="c4" href="http://www.google.com/url?q=http%3A%2F%2Fopenbabel.org&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNH4G4NsH9uBklQVo5HpM7VNGRrqww">http://openbabel.org</a></span><span>)</span></li></ul><ul class="c5 lst-kix_6xt1kwty0bal-1 start"><li class="c2"><span>only required when building molecules from SMILES strings or other formats that are not supported by antechamber </span></li><li class="c2"><span>tested with version 2.3.2 </span></li></ul><h1 class="c6 c7"><a name="h.fue2h2cud1be"></a><span class="c3">The executables for these programs (CHARMM, antechamber, and obabel) are assumed to be in the path when the script is run.</span></h1><h1 class="c6 c7"><a name="h.eto1ardohdf7"></a><span>Compiling CHARMM</span></h1><p class="c6"><span>This system requires that CHARMM be run in parallel using MPI. CHARMM must be compiled with MPI parallelization and the replica exchange features (repdstr).To use the semi-empirical QM module of CHARMM &nbsp;to represent the molecule, the SQ keyword must be used. The suggested command line for compiling CHARMM for use with these scripts is:</span></p><p class="c6 c9"><span></span></p><p class="c6"><span class="c8">./install.com gnu large M MPIF90 SQ +REPDSTR +GENCOMM &nbsp;+CMPI</span></p><p class="c6 c9"><span></span></p><p class="c6"><span>After compilation is completed, you should copy the charmm executable to the working directory or modify the conformation-search.sh script so that the fully-qualified path is included in used at both instances.</span></p><h1 class="c6 c7"><a name="h.of2ozm8wnas"></a><span>Options</span></h1><p class="c6"><span>The execution options for this script are specified in the file </span><span class="c8">settings.str</span></p><ul class="c5 lst-kix_1wqoavz9rnai-0 start"><li class="c0"><span>NREPLICAS</span></li></ul><ul class="c5 lst-kix_1wqoavz9rnai-1 start"><li class="c2"><span>Specifies the number of replicas to simulation in the REMD simulation</span></li><li class="c2"><span>This should not exceed the number of processors available to be run in parallel</span></li><li class="c2"><span>A sufficient number of replicas must be used so that neighbouring replicas are close in temperatures</span></li><li class="c2"><span>Default value: 20</span></li></ul><ul class="c5 lst-kix_1wqoavz9rnai-0"><li class="c0"><span>LOWT</span></li></ul><ul class="c5 lst-kix_1wqoavz9rnai-1 start"><li class="c2"><span>Specifies the temperature of the lowest temperature replica in Kelvin</span></li><li class="c2"><span>If you are searching for the global potential energy minimum, this should be sufficiently low so that only lowest energy conformation is likely to be populated at the lowest temperature; however, larger temperature ranges need more replicas.</span></li><li class="c2"><span>Default value: 50 </span></li></ul><ul class="c5 lst-kix_1wqoavz9rnai-0"><li class="c0"><span>HIGHT</span></li></ul><ul class="c5 lst-kix_1wqoavz9rnai-1 start"><li class="c2"><span>Specifies the temperature of the lowest temperature replica in Kelvin</span></li><li class="c2"><span>The inclusion of high temperature replicas; however, if it is set too high (e.g. &gt; 1000 K), the simulation can become numerically unstable and non-physical isomerizations can occur (e.g. rotations around double bonds), especially in QM simulations.</span></li><li class="c2"><span>Default value: 500 </span></li></ul><ul class="c5 lst-kix_1wqoavz9rnai-0"><li class="c0"><span>NSTEPS</span></li></ul><ul class="c5 lst-kix_1wqoavz9rnai-1 start"><li class="c2"><span>Specifies the number of time steps steps to perform. Each time step is 1 fs in length (1 fs = 10</span><span class="c10 c12">&minus;</span><span class="c10">15 </span><span>s). This should be sufficiently large to allow the simulation to find the lowest energy conformation.</span></li><li class="c2"><span>Default value: 1000000</span></li></ul><ul class="c5 lst-kix_1wqoavz9rnai-0"><li class="c0"><span>XFREQ</span></li></ul><ul class="c5 lst-kix_1wqoavz9rnai-1 start"><li class="c2"><span>The number of time steps between replica exchange attempts</span></li><li class="c2"><span>Default value: 1000 </span></li></ul><ul class="c5 lst-kix_1wqoavz9rnai-0"><li class="c0"><span>QM</span></li></ul><ul class="c5 lst-kix_1wqoavz9rnai-1 start"><li class="c2"><span>Defines whether to represent the molecule with an molecular mechanical model (QM = 0) or with a semi-empirical quantum mechanical model (QM = 1)</span></li><li class="c2"><span>Default value: 0</span></li></ul><ul class="c5 lst-kix_1wqoavz9rnai-0"><li class="c0"><span>QMCHARGE</span></li></ul><ul class="c5 lst-kix_1wqoavz9rnai-1 start"><li class="c2"><span>Stores the net charge of the molecule for QM calculations</span></li><li class="c2"><span>Default value: 0</span></li></ul><ul class="c5 lst-kix_1wqoavz9rnai-0"><li class="c0"><span>QMMETHOD</span></li></ul><ul class="c5 lst-kix_1wqoavz9rnai-1 start"><li class="c2"><span>Specifies which semi-empirical QM method to use in QM calculations. The options are limited to am1, pm3, or mndo</span></li><li class="c2"><span>Default value: pm3</span></li></ul><h1 class="c6 c7"><a name="h.hsfdkeb42x5f"></a><span>Execution</span></h1><p class="c6"><span>The directory must contain mol.rtf, where the molecule that conformational search is being performed on is defined as &quot;RESI MOL&quot;. The directory must also contain a file, mol.prm, that contains. It is recommended to use antechamber to generate these parameters from the Generalized Amber Force Field (GAFF), although these parameters will be ignored when a QM model is used.</span></p><p class="c6 c9"><span></span></p><p class="c6"><span class="c8">mpirun -np 20 charmm &lt; remd.inp &gt; remd.out</span></p><p class="c6 c9"><span></span></p><p class="c6"><span>It may be necessary to modify the mpirun command line to point to the host file or the correct path for the version of mpirun used in the compilation. By default, the simulation will use 20 replicas on When the simulation completes, the minimum energy structure is saved to </span></p><p class="c6"><span>the files min_pdb_# in PDB format. The energy of this conformation is stored in the</span></p><p class="c6"><span>first line of these files. The structure of the minimum temperature structure (min_pdb_0)</span></p><p class="c6"><span>will often be the lowest energy structure, although it is possible that one of the</span></p><p class="c6"><span>higher temperature replicas will hold the lowest energy structure.</span></p><p class="c6 c9"><span></span></p><p class="c6"><span>When a QM method is used, it becomes possible for chemical reactions to occur</span></p><p class="c6"><span>in high temperature replicas, so isomerizations and fragmentations can occur. This can be prevented by adding restraints to the remd.inp script to prevent specific thermally accessible reaction mechanisms or by using a lower maximum temperature in the replica exchange.</span></p><h1 class="c6 c7"><a name="h.bscbj92to94j"></a><span>Example</span></h1><p class="c6"><span>The included example builds maltose from its SMILES string, then uses CHARMM to perform a replica exchange conformation search. This example is executed by:</span></p><p class="c6 c9"><span></span></p><p class="c6"><span class="c8">cd example</span></p><p class="c6"><span class="c8">./conformation-search.sh</span></p><p class="c6 c9"><span></span></p><p class="c6"><span>The lowest energy conformation will be written to min_pdb_0.</span></p></body></html>